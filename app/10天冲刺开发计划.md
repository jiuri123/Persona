### 10天冲刺开发计划

### 📅 你的 10 天 (Nov 20 - Nov 29) 作战计划

**核心目标：**

- **Day 1-6 (基础冲刺):** 100% 完成 "四、基础要求"，搭建好可扩展的 MVVM 架构。
- **Day 7-9 (进阶挑战):** 攻坚 "进阶挑战 (富文本/流式)" 和 "进阶挑战  (架构优化)" 。
- **Day 10 (收尾):** 录制视频并撰写深度报告。

#### 阶段一：基础功能与架构搭建 (Day 1 - Day 6)

**Day 1 (Nov 20): 项目搭建与主导航**（完成！）

- **🎯 目标:** 搭建 App 空壳，实现底部导航栏切换 3 个主页面。
- **📚 学习重点:** Android Studio 项目结构、`Activity` 与 `Fragment` 的区别、`BottomNavigationView` 的使用、View Binding。
- **✅ 任务清单:**
  1. **项目创建:** 创建一个使用 Java 和 XML 的新 Android Studio 项目。
  2. **主布局:** 修改 `MainActivity.xml`，在底部放置一个 `BottomNavigationView`。
  3. **创建 Fragments:** 创建三个空的 `Fragment`：
     - `SocialSquareFragment` (社交广场)
     - `MyPersonaFragment` (Persona 共生/私聊)
     - `ProfileFragment` (为进阶3“多账户”预留)
  4. **导航实现:** 在 `MainActivity.java` 中设置监听，使点击底部导航栏时，能正确切换显示上述 3 个 `Fragment`。
  5. **启用 View Binding:** 在 `build.gradle` 文件中开启 View Binding，并修改 `MainActivity` 和 3 个 `Fragment`，使用 View Binding 访问视图，告别 `findViewById`。

**Day 2 (Nov 21): 数据模型与广场 UI (RecyclerView)**（完成！）

- **🎯 目标:** 定义核心数据类，并使用 `RecyclerView` 显示一个静态的“社交广场”列表。
- **📚 学习重点:** **`RecyclerView` (核心)**、`Adapter`、`ViewHolder` 的概念、XML 布局 (LinearLayout, ConstraintLayout)。
- **✅ 任务清单:**
  1. **数据模型 (Model):** 创建两个 POJO (Plain Old Java Object) 类：
     - `Persona.java` (包含 name, avatarUrl, bio, story 等)
     - `PersonaPost.java` (包含 Persona, postContent, imageUrl, timestamp 等)
  2. **Mock 数据:** 创建一个 `MockData.java` 工具类，静态返回一个 `List<PersonaPost>`。
  3. **列表项 UI:** 创建 `item_persona_post.xml` 布局文件，用于设计“社交广场”中每一条动态的样式（如头像、昵称、内容）。
  4. **`RecyclerView` 搭建:**
     - 在 `SocialSquareFragment.xml` 中添加 `RecyclerView`。
     - 创建 `SocialPostAdapter.java`，继承 `RecyclerView.Adapter`，并实现其 `ViewHolder`。
     - 在 `SocialSquareFragment.java` 中，初始化 `RecyclerView` 和 `SocialPostAdapter`，并加载 `MockData` 显示列表。
  5. **图片加载:** 引入 `Glide` 库，并在 `Adapter` 中用它来加载头像和动态图片。

**Day 3 (Nov 22): MVVM 架构重构**（完成）

- **🎯 目标:** 将 Day 2 的实现重构为 MVVM + Repository 架构。

- **📚 学习重点:** **`ViewModel`、`LiveData`、`Repository` 模式**。这是拉开差距的关键。

- **✅ 任务清单:**

  1. **添加依赖:** 引入 `ViewModel` 和 `LiveData` 的库。
  2. **Repository:** 创建 `SocialRepository.java`。它有一个方法 `getSocialPosts()`，目前该方法从 `MockData` 获取数据。
  3. **ViewModel:** 创建 `SocialSquareViewModel.java`。
     - 它持有一个 `SocialRepository` 实例。
     - 它暴露一个 `LiveData<List<PersonaPost>>` 给 View。
     - 在 `init` 块或构造函数中，调用 Repository 获取数据，并更新 `LiveData`。
  4. **Fragment (View) 重构:**
     - 修改 `SocialSquareFragment.java`。
     - **删除**所有 MockData 的直接调用。
     - 获取 `SocialSquareViewModel` 实例。
     - **“订阅”** ViewModel 中的 `LiveData`：`viewModel.getPosts().observe(...)`。
     - 在 `observe` 回调中，将新数据提交给 `SocialPostAdapter`。

  - **💡 效果:** 你的 Fragment (View) 不再关心数据从哪来，只负责展示。

**Day 4 (Nov 23): Persona 创作与共生 (私聊) UI**（完成！）

- **🎯 目标:** 完成“Persona 创作”页，并搭建“与我的 Persona 私聊”的聊天 UI。
- **📚 学习重点:** `Activity/Fragment` 间跳转与传参、`RecyclerView` (多 ViewType)。
- **✅ 任务清单:**
  1. **Persona 创作:**
     - 创建 `CreatePersonaActivity.java` 及其 XML 布局（包含 `EditText` 用于输入名称、故事等，`ImageView` 用于头像，`Button` 用于“AI 生成”和“创建”）。
  2. **`MyPersonaFragment` 逻辑:** 在 `MyPersonaFragment` 中添加逻辑：如果用户还没有 Persona，显示一个“创建”按钮，点击跳转到 `CreatePersonaActivity`。
  3. **聊天 UI:**
     - 在 `MyPersonaFragment` 中（假设已创建 Persona），显示聊天界面（底部 `EditText` 和“发送”按钮，上方一个 `RecyclerView`）。
     - 创建两个聊天 item 布局：`item_chat_sent.xml` (用户) 和 `item_chat_received.xml` (Persona)。
     - 创建 `ChatAdapter.java`，它需要**支持多种 ViewType** (根据消息发送者返回不同布局)。
  4. **本地模拟:** 点击“发送”按钮，暂时只把消息添加到 `ChatAdapter` 的列表中并刷新 `RecyclerView`，模拟对话。

**Day 5 (Nov 24): 对话 API 接入 (Retrofit + LLM)**（完成！）

- **🎯 目标:** 接入云端大模型 API，让“Persona 共生”私聊真正跑起来。
- **📚 学习重点:** **`Retrofit2` (网络请求)**、`Gson` (JSON 解析)、LLM API 调用。
- **✅ 任务清单:**
  1. **API 准备:** 注册一个 LLM API 服务（如 Gemini, OpenAI, Kimi 等），获取 API Key。
  2. **添加依赖:** 引入 `Retrofit2` 和 `converter-gson`。
  3. **Retrofit 设置:**
     - 创建 `ApiService.java` (Interface)，定义聊天请求的 `@POST` 接口。
     - 创建 `ApiClient.java`，用于构建 `Retrofit` 实例。
  4. **MVVM 接入:**
     - 创建 `ChatRepository.java`，封装 `ApiService` 的网络调用。
     - 创建 `MyPersonaViewModel.java`。
     - 在 `MyPersonaFragment` 中，当用户点击“发送”：
       1. 将消息显示在 UI 上。
       2. 调用 `ViewModel` 的 `sendMessage(text)` 方法。
       3. `ViewModel` 调用 `Repository` 发起网络请求。
       4. **关键**：在请求中，将 Persona 的人设（背景故事等）作为 Prompt 的一部分发给 AI。
       5. `Repository` 异步返回结果，`ViewModel` 更新 `LiveData`，`Fragment` 监听到 `LiveData` 变化，将 AI 的回复显示在 `ChatAdapter` 中。

**Day 6 (Nov 25): 完善基础功能 (广场交互与任意聊天)**（完成！）

- **🎯 目标:** 100% 完成所有基础要求。

- **📚 学习重点:** `Activity` 间数据传递、复用 `ViewModel` 和 `Activity`。

- **✅ 任务清单:**

  1. **AI 辅助创作:** 在 `CreatePersonaActivity` 中，点击“AI 生成”按钮，调用 Day 5 的 `ApiService` 生成人设和故事，并填充到 `EditText` 中。
  2. **动态发布 (Mock):** 在 `SocialSquareFragment` 添加一个“+”号按钮，点击后（用 Mock 数据）在列表中插入一条新动态。
  3. **关注 (Mock):** 在 `item_persona_post.xml` 上添加“关注”按钮，点击后（用 Mock 数据）更新 UI 状态。
  4. 任意 Persona 聊天:
     - 创建 `ChatActivity.java`（复用 Day 4 的聊天 UI 布局）。
     - 在 `SocialPostAdapter` (广场列表) 中添加点击事件，当用户点击*任意* Persona 的头像或昵称时：
       - 启动 `ChatActivity`，并通过 `Intent` **传入被点击的 `Persona` 对象**。
       - `ChatActivity` 根据传入的 `Persona` 人设，调用 `ViewModel` 和 API 进行对话。

  - **🎉 里程碑:** 此时，所有基础功能已全部完成！

#### 阶段二：进阶挑战与收尾 (Day 7 - Day 10)

**Day 7 (Nov 26): 进阶 1 - 体验优化 (Markdown & 流式)**

- **🎯 目标:** 完成进阶挑战 1。
- **📚 学习重点:** 引入第三方库、`Handler` / `Runnable`。
- **✅ 任务清单:**
  1. **Markdown 渲染:**
     - 引入一个 Markdown 渲染库 (如 `Markwon`)。
     - 修改 `ChatAdapter`，在绑定 AI 回复的 `ViewHolder` 中，使用 `Markwon` 库来渲染文本，而不是简单的 `setText`。
  2. **流式输出 (打字机效果):**
     - **方案A (真·流式):** 如果你的 LLM API 支持 SSE (Server-Sent Events)，你需要用 OkHttp 的 `EventSource` 来实现。这在 10 天内难度极高，不推荐。
     - **方案B (模拟流式):** **强烈推荐此方案。** 拿到 API 的**完整**回复后，不要一次性 `setText`。写一个工具类或在 `Adapter` 中使用 `Handler`，每隔 50 毫秒向 `TextView` 追加一个字符，实现“打字机”效果。这同样能展示你对交互优化的思考。

**Day 8 (Nov 27): 进阶 3 - 架构优化 (Part 1: 本地数据库)**

- **🎯 目标:** 开始 "从 Mock 走向真实服务"，引入本地数据库。
- **📚 学习重点:** **`Room` 数据库 (核心)**、`Entity`、`DAO`。
- **✅ 任务清单:**
  1. **引入 Room:** 添加 `Room` 依赖。
  2. **`@Entity`:** 修改你的 `Persona.java`, `PersonaPost.java` 等数据模型，添加 `@Entity` 注解。
  3. **`@DAO` (Data Access Object):** 创建 `PersonaDao.java` 等接口，定义数据库的增删改查方法 (如 `insertPersona`, `getAllPosts`)。
  4. **`RoomDatabase`:** 创建 `AppDatabase.java` (继承 `RoomDatabase`)。
  5. **修改 Repository:**
     - 创建 `LocalDataSource.java` (封装 DAO 调用) 和 `RemoteDataSource.java` (封装 Retrofit 调用)。
     - **关键：** 修改 `SocialRepository` 和 `ChatRepository`。现在它们的数据来源不再是 `MockData`，而是 `LocalDataSource` (Room) 。
     - **数据流：** Fragment -> ViewModel -> Repository -> LocalDataSource (Room)。

**Day 9 (Nov 28): 进阶 3 - 架构优化 (Part 2: 多账户隔离)**

- **🎯 目标:** 证明架构弹性，实现多账户数据隔离。
- **📚 学习重点:** 数据库表结构设计、Repository 模式的弹性。
- **✅ 任务清单:**
  1. **用户系统 (极简):**
     - 创建 `User.java` (@Entity)。
     - 创建 `LoginActivity.java` (一个 `EditText` 输用户名，点击即“登录”，并将 `User` 信息存入 `SharedPreferences`)。
  2. **数据隔离 (关键):**
     - 修改 `Persona`, `PersonaPost` 等 Entity，为它们添加 `userId` 字段 (外键)。
  3. **修改 DAO 和 Repository:**
     - 所有的数据查询**必须**携带 `currentUserId`。
     - 例如：`SocialRepository.getSocialPosts(String userId)`。
     - `ViewModel` 从 `SharedPreferences` 获取当前用户 ID，并传递给 `Repository`。
  4. **测试:** 退出登录，换个用户名登录，确保看不到上个用户创建的 Persona 和动态。这完美证明了你的架构支持从“单机”到“真实服务”的演进。

**Day 10 (Nov 29): 报告、视频与提交**

- **🎯 目标:** 打包所有产出物。
- **📚 学习重点:** 清晰的文档表达和功能演示。
- **✅ 任务清单:**
  1. **深度项目报告 (5 小时):** 这是重中之重。
     - Part 1: 必须画出你的 **MVVM + Repository 架构图**。说明技术选型 (为什么是 Java, Room, Retrofit)。
     - Part 2: 重点写 **"进阶挑战 3"**。详细说明你如何通过 Repository 模式、Room 和 `userId` 隔离，实现了从 Mock 到多账户本地真实数据的演进，以及这套架构如何“无缝切换”到真实后端 API。
     - Part 3: 你的反思：最大的困难 (如第一次用 RecyclerView、接入 API 异步处理)，以及你如何解决的。
  2. **演示视频 (1.5 小时):** 使用 Android Studio 自带的录屏功能。务必清晰展示所有基础功能，以及你完成的 Markdown、流式（模拟）和多账户切换功能。
  3. **代码自查 (1 小时):** 检查代码注释、README 文档、删除无用代码和 API Key 硬编码。

**Buffer (Nov 30): 提交日**

- 这一天是你的缓冲区，用于处理 Day 10 没做完的收尾工作、压缩文件、最后检查 PDF 报告，并在截止时间前提交。